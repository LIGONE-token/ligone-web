<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LIGONE Community App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin: 0;
        background: #0e0e0e;
        font-family: Arial, sans-serif;
        color: white;
    }

    header {
        background: #1a1a1a;
        padding: 15px;
        display: flex;
        align-items: center;
        gap: 15px;
        border-bottom: 2px solid #333;
    }

    header img {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #fff;
        display: block;
    }

    h1 {
        font-size: 22px;
        margin: 0;
    }

    /* Chat */
    #chat {
        height: 300px;
        overflow-y: auto;
        padding: 10px;
        background: #111;
        border-bottom: 2px solid #333;
    }

    .message {
        margin-bottom: 12px;
        padding: 10px;
        background: #222;
        border-radius: 8px;
    }

    .translated {
        margin-top: 4px;
        color: #bbbbbb;
        font-size: 14px;
    }

    #controls {
        padding: 10px;
        background: #1a1a1a;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    input, textarea, select {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: none;
    }

    button {
        padding: 14px;
        background: #008cff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
    }

    button:hover {
        background: #0aa0ff;
    }
</style>
</head>

<body>

<header>
    <img src="logo.png" alt="LIGONE Logo">
    <h1>LIGONE Community Chat</h1>
</header>

<!-- CHAT -->
<div id="chat"></div>

<div id="controls">
    <input id="username" placeholder="Dein Name">
    <textarea id="message" placeholder="Nachricht schreiben..." rows="3"></textarea>

    <label>Sprache für Übersetzung:</label>
    <select id="lang">
        <option value="de">Deutsch</option>
        <option value="en" selected>English</option>
        <option value="fr">Français</option>
        <option value="es">Español</option>
        <option value="it">Italiano</option>
        <option value="pt">Português</option>
        <option value="ru">Русский</option>
        <option value="tr">Türkçe</option>
        <option value="pl">Polski</option>
    </select>

    <button onclick="sendMessage()">Senden</button>
</div>

<!-- GECKOTERMINAL CHART -->
<section id="chart" style="padding:20px; background:#111; border-top:2px solid #333; border-bottom:2px solid #333; margin-top:30px;">
    <h2 style="color:white; text-align:center; margin-bottom:15px;">
        LIGONE Live Chart (GeckoTerminal)
    </h2>

    <iframe 
        src="https://www.geckoterminal.com/polygon_pos/pools/0x4cae394e939f53d52546e4483717bf10c94bc4ab?embed=1&info=1&swaps=1"
        style="border:0; width:100%; height:600px; border-radius:12px; overflow:hidden;"
        allowfullscreen
        loading="lazy">
    </iframe>
</section>

<script>
// Broadcast Channel für den öffentlichen Live-Chat
const chatChannel = new BroadcastChannel("ligone_public_chat");
const chatDiv = document.getElementById("chat");

function addMessage(name, text, translated = "") {
    const div = document.createElement("div");
    div.className = "message";
    div.innerHTML = `
        <strong>${name}</strong><br>${text}
        ${translated ? `<div class='translated'>${translated}</div>` : ""}
    `;
    chatDiv.appendChild(div);
    chatDiv.scrollTop = chatDiv.scrollHeight;
}

function translate(text, lang) {
    return `[${lang}] ${text}`; 
}

function sendMessage() {
    const name = document.getElementById("username").value || "Gast";
    const msg = document.getElementById("message").value;
    const lang = document.getElementById("lang").value;

    if (!msg.trim()) return;

    const translated = translate(msg, lang);

    addMessage(name, msg, translated);

    chatChannel.postMessage({ name, msg, translated });

    document.getElementById("message").value = "";
}

chatChannel.onmessage
