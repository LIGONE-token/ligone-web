name: PROOF - Action writes to repo

permissions:
  contents: write

on:
  workflow_dispatch:
  schedule:
    - cron: "*/5 * * * *"

jobs:
  proof:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Write proof file
        run: |
          node <<'EOF'
          const fs = require("fs");
          const msg = "ACTION_RAN_AT_" + new Date().toISOString();
          fs.writeFileSync("PROOF.txt", msg);
          console.log(msg);
          EOF

      - name: Commit proof
        run: |
          git config user.name "action-proof"
          git config user.email "action-proof@bot"
          git add PROOF.txt
          git commit -m "PROOF: action can write to repo" || exit 0
          git push
