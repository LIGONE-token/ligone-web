<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIGONE Monitor</title>

<style>
body {
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background:#0b0e11;
  color:#e5e7eb;
}

header {
  padding:20px;
  background:#111827;
  border-bottom:1px solid #1f2937;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

h1 {
  margin:0;
  font-size:20px;
}

.status {
  font-size:12px;
  color:#10b981;
}

.container {
  padding:20px;
  max-width:1100px;
  margin:auto;
}

.grid {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(250px,1fr));
  gap:20px;
  margin-bottom:30px;
}

.card {
  background:#111827;
  padding:25px;
  border-radius:14px;
  border:1px solid #1f2937;
  transition:0.3s;
}

.card:hover {
  border-color:#2563eb;
}

.card h2 {
  margin:0 0 12px 0;
  font-size:14px;
  color:#9ca3af;
  letter-spacing:0.5px;
}

.card p {
  margin:0;
  font-size:22px;
  font-weight:700;
}

.positive { color:#10b981; }
.negative { color:#ef4444; }

.section {
  background:#111827;
  padding:25px;
  border-radius:14px;
  border:1px solid #1f2937;
  margin-bottom:20px;
}

.countdown {
  font-size:18px;
  font-weight:600;
}

.footer {
  text-align:center;
  font-size:12px;
  color:#6b7280;
  margin-top:30px;
}
  nav a:hover {
  color:#ffffff;
}

</style>
</head>

<body>

<header>
  <h1>LIGONE Monitor</h1>
  <nav style="display:flex; gap:15px; font-size:13px;">
    <a href="index.html" style="color:#9ca3af; text-decoration:none;">Start</a>
    <a href="gewinnspiel.html" style="color:#9ca3af; text-decoration:none;">Gewinnspiel</a>
    <a href="https://ligone-token.github.io/marketshield/" target="_blank" style="color:#9ca3af; text-decoration:none;">
      MarketShield
    </a>
  </nav>
</header>


<div class="container">

<div class="grid">

  <div class="card">
    <h2>LIG1 Preis</h2>
    <p id="price">L√§dt...</p>
  </div>

  <div class="card">
    <h2>Liquidity</h2>
    <p id="liquidity">L√§dt...</p>
  </div>

  <div class="card">
    <h2>Jackpot</h2>
    <p id="jackpot">L√§dt...</p>
  </div>

</div>

<div class="section">
  <h2>24h Ver√§nderung</h2>
  <p id="change">L√§dt...</p>
</div>

<div class="section">
  <h2>24h Verlauf</h2>
  <canvas id="chart" height="100"></canvas>
</div>
  
<div class="section">
  <h2>N√§chste Ziehung</h2>
  <div class="countdown" id="countdown">L√§dt...</div>
</div>

  <div class="section">
  <h2>Asset Stability Monitor</h2>

  <div style="margin-bottom:15px;">
    <button onclick="loadStability(30)" style="margin-right:10px;">30 Tage</button>
    <button onclick="loadStability(90)">90 Tage</button>
  </div>

  <table id="stability-table" style="width:100%; border-collapse:collapse;">
    <thead>
      <tr style="text-align:left; border-bottom:1px solid #1f2937;">
        <th>Asset</th>
        <th>Volatilit√§t</th>
        <th>Drawdown</th>
        <th>Stabilit√§t</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="footer">
Auto-Update alle 60 Sekunden
</div>

</div>

<script>

const POOL_API = "https://api.geckoterminal.com/api/v2/networks/polygon_pos/pools/0xd6791279b261c36c1e079ece8cb05079cc5e7e38";
const JACKPOT_JSON = "data/amount.json";

// üìà Mini Chart
async function loadChart() {
  try {
    const res = await fetch(POOL_API);
    const data = await res.json();
    const change = parseFloat(data.data.attributes.price_change_percentage.h24);

    const canvas = document.getElementById("chart");
    const ctx = canvas.getContext("2d");
    const width = canvas.width = canvas.offsetWidth;
    const height = canvas.height = 100;

    ctx.clearRect(0,0,width,height);
    ctx.beginPath();
    ctx.lineWidth = 2;
    ctx.strokeStyle = change >= 0 ? "#10b981" : "#ef4444";

    for (let i = 0; i < width; i++) {
      const progress = i / width;
      const y = height/2 - (change * progress * 2);
      if (i === 0) ctx.moveTo(i,y);
      else ctx.lineTo(i,y);
    }

    ctx.stroke();

  } catch(e) {
    console.log("Chart Fehler");
  }
}

// üí∞ Preis + Liquidity
async function loadPool() {
  try {
    const res = await fetch(POOL_API);
    const data = await res.json();
    const attr = data.data.attributes;

    document.getElementById("price").innerText =
      parseFloat(attr.base_token_price_usd).toFixed(6) + " USD";

    document.getElementById("liquidity").innerText =
      "$" + Math.round(attr.reserve_in_usd).toLocaleString();

    const change = parseFloat(attr.price_change_percentage.h24);
    const changeEl = document.getElementById("change");

    changeEl.innerText = change.toFixed(2) + " %";
    changeEl.className = change >= 0 ? "positive" : "negative";

  } catch {
    document.getElementById("price").innerText = "Fehler";
  }
}

// üé∞ Jackpot
async function loadJackpot() {
  try {
    const res = await fetch(JACKPOT_JSON);
    const data = await res.json();
    document.getElementById("jackpot").innerText =
      data.amount + " ‚Ç¨";
  } catch {
    document.getElementById("jackpot").innerText = "n/a";
  }
}

// ‚è≥ Countdown bis 18:00 Z√ºrich
function updateCountdown() {
  const now = new Date();
  const target = new Date();
  target.setHours(18,0,0,0);
  if (now > target) target.setDate(target.getDate()+1);

  const diff = target - now;
  const hours = Math.floor(diff/1000/60/60);
  const minutes = Math.floor((diff/1000/60)%60);
  const seconds = Math.floor((diff/1000)%60);

  document.getElementById("countdown").innerText =
    hours+"h "+minutes+"m "+seconds+"s";
}

// üöÄ INIT
loadPool();
loadJackpot();
loadChart();
updateCountdown();

setInterval(() => {
  loadPool();
  loadJackpot();
  loadChart();
}, 60000);

setInterval(updateCountdown,1000);
// üìä Stability Monitor
async function loadPerformance() {
  try {
    const res = await fetch(
      "data/performance-since-2026-01-16.json?v=" + Date.now(),
      { cache: "no-store" }
    );

    const data = await res.json();

    const tbody = document.querySelector("#stability-table tbody");
    tbody.innerHTML = "";

    data.forEach(asset => {

      const row = document.createElement("tr");
      row.style.borderBottom = "1px solid #1f2937";

      const total = asset.total_percent.toFixed(2) + " %";
      const avg = asset.avg_daily_percent.toFixed(4) + " %";

      row.innerHTML = `
        <td>${asset.asset}</td>
        <td>${total}</td>
        <td>${avg}</td>
        <td>seit 16.01.2026</td>
      `;

      tbody.appendChild(row);
    });

  } catch(e) {
    console.log("Performance Fehler", e);
  }
}

// Standardm√§√üig 30 Tage laden
loadPerformance();


  
</script>


</body>
</html>
